<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://kit.fontawesome.com/9139d48468.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<!-- <script defer src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.11.0/mdb.min.js"></script> -->
<script src="https://kit.fontawesome.com/bdf5ca2238.js" crossorigin="anonymous"></script>
    <style>
        /* Overall Layout */
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
        }

        .checkout-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            margin: 10px 0;
        }

        /* Addresses Section */
        .addresses-section {
            border-bottom: 1px solid #ddd;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        #address {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .add-address-button {
            display: block;
            width: 100%;
            padding: 10px 20px;
            background-color: hwb(48 4% 7%);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        /* Cart Details Section */
        .cart-details-section {
            border-bottom: 1px solid #ddd;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        #cart-table {
            border-collapse: collapse;
            width: 100%;
        }

        #cart-table th, #cart-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        /* Order Summary Section */
        .order-summary-section {
            border-bottom: 1px solid #ddd;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        /* Payment Options Section */
        .payment-options-section {
            border-bottom: 1px solid #ddd;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .payment-options-section ul {
            list-style: none;
            padding: 0;
        }

        .payment-options-section ul li {
            margin-bottom: 10px;
        }

        .payment-options-section label {
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }

        .payment-option-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        /* Buttons */
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Error messages (optional) */
        .error {
            color: red;
            font-weight: bold;
        }

        /* Adjust image size */
        .img-fluid {
            max-width: 90px;
            max-height: 96px;
            width: auto;
            height: auto;
            border-radius: 4px;
        }

        body {
                font-family: Arial, sans-serif;
                background-color: #f9f9f9;
             
            }
            @import url('https://fonts.googleapis.com/css?family=Roboto:400,500,700');
*
{
    -webkit-box-sizing: border-box;
            box-sizing: border-box;

}
body {
    padding-top: 6px; /* Adjust based on the height of your navbar */
    font-family: 'Poppins', sans-serif;
 
    background-color: #f5f5f5;
    /* display: flex; */
    
}




.navbar {
    background-color: #ffffff; /* White background */
     box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1); /* Box shadow for subtle depth */
     width: 100%;
     position: fixed;
     position: relative;
} */

.navbar-brand {
    padding: 0.5rem 2rem;
    margin-right: 2rem;
    
}

.navbar-logo {
    width: 50px;
    height: auto;
}

.navbar-toggler-icon {
    background-color: #1a63ab; /* Dark Gray color for toggler icon */
    
}

.navbar-nav {
    margin-left: auto; /* Adjusted to move items to the right */
    
}
 

.nav-item {
    margin-left: 1.5rem;
   
}

.nav-link {
    color: #000000; /* Dark Gray color for nav links */
    font-weight: bold;
    transition: color 0.3s ease-in-out;
}

.nav-link:hover {
    color: #060606; /* Red color on hover */
}

.profile-icon {
    background-color: #bc050500; /* Red color for profile icon background */
    color: #a61414; /* White color for the icon */
    border-radius: 50%;
    padding: 5px;
    font-size: 1.2rem;
    transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out;
}

.profile-icon:hover {
    background-color: #ed0b0b00; /* Dark Gray color on hover */
    color: #15ba29; /* White color on hover */
}

.dropdown-menu {
    background-color: #2c2b2b; /* White background for dropdown menu */
}

.dropdown-item {
    color: #ffffff; /* Dark Gray color for dropdown items */
    font-weight: bold;
    transition: color 0.3s ease-in-out;
}

.dropdown-item:hover {
    color: #f60505; /* Red color on hover */
}

.product-heading{
    text-align: center;
    padding-left: 22px;
    
}
.product-heading h2{
    margin-top: 150px;
    font-weight: 700;
  
}

.navbar.fixed-top {
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
}

.navMAin {
    margin-top: 56px; /* Adjusted to account for the fixed-top navbar height */
}
.section-padding{
    padding: 100px 0; 
    }



    </style>
</head>
<body>

    <main class="navMAin">
        <nav class="navbar navbar-expand-lg navbar-light  fixed-top">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">
                    <img src="/img/logo.png" alt="Logo" class="navbar-logo">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="/forhim">For Him</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/forher">For Her</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link profile-icon" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-user"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">

                                <a class="dropdown-item" href="#">Wishlist</a>
                                <a class="dropdown-item" href="/CartView">Cart</a>
                                <a class="dropdown-item" href="/login">Login</a>
                                <a class="dropdown-item" href="/signout">Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </main>


    <div class="checkout-container">
        <h1>Checkout</h1>
        <form id="checkoutForm">
            <div class="addresses-section">
                <h3>Select Delivery Address</h3>
                <select class="form-control" id="address" name="address">
                    <% addresses.forEach(address => { %>
                        <option>
                            <%= address.addressType %> -
                            <%= address.district %>,
                            <%= address.state %>,
                            <%= address.flat %>,
                            <%= address.pincode %>,
                            <%= address.country %> -,
                            
                            <%= address.mobileNumber %>
                        </option>
                    <% }); %>
                </select>
                <button class="add-address-button">Add Address</button>
            </div>
        </form>

        <div class="cart-details-section">
            <h3>Your Cart</h3>
            <table id="cart-table">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Product</th>
                        <th>Description</th>
                        <th>Quantity</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    <% cartItems.forEach(item => { %>
                        <tr>
                            <td>
                             
                                    <img src="<%= item.productId.productImages[0] %>" alt="Product Image" class="img-fluid" />
                               
                            </td>
                            <td><%= item.productId.name %></td>
                            <td><%= item.productId.description  %></td>
                            <td><%= item.quantity %></td>
                            <td>₹<%= item.productId.price %></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
        
        
        
        <div class="order-summary-section">
            <h3>Order Summary</h3>
            <h1>Total: ₹<span id="totalPrice"><%= totalPrice %></span></h1>
        </div>

        <div class="payment-options-section">
            <h3>Payment Method</h3>
            <form>
                <ul>
                    <li>
                        <input type="radio" id="cash-on-delivery" name="paymentMethod" value="cod" checked>
                        <label for="cash-on-delivery">
                            <i class="fa-solid fa-sack-dollar"></i>
                            Cash on Delivery
                        </label>
                    </li>
                    <li>
                        <input type="radio" id="online-payment" name="paymentMethod" value="online">
                        <label for="online-payment">
                            <i class="fa-brands fa-google-pay"></i>
                            Online Payment
                        </label>
                    </li>
                    <li>
                        <input type="radio" id="card-payment" name="paymentMethod" value="card">
                        <label for="card-payment">
                            <i class="fa-solid fa-credit-card"></i>
                            Card Payment
                        </label>
                    </li>
                </ul>
            </form>
        </div>

        <button class="btn btn-primary" onclick="submitOrder()">Place Order</button>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script>
     async function submitOrder() {
    try {
        // Get the selected address from the dropdown
        const selectedAddress = document.getElementById('address').value;
        console.log(selectedAddress);

        // Get the selected payment method
        const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
        console.log(paymentMethod);
        // Create an object with the necessary data
        const orderData = {
            selectedAddress,
            paymentMethod,
        };

        // Make a POST request to the server
        const response = await fetch('/checkout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(orderData),
        });

        // Handle the response as needed (e.g., show a success message to the user)
        const result = await response.json();
        console.log(result);
        window.location.href = "/order";
    } catch (error) {
        console.error(error);
    }
}

    </script>

<!-- Include custom JS -->
<script>
    // Show/hide the new address form
    function showNewAddressForm() {
        var newAddressForm = document.querySelector('.new-address-form');
        newAddressForm.style.display = newAddressForm.style.display === 'none' ? 'block' : 'none';
    }
</script>

</body>
</html>
